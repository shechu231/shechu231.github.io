
<!DOCTYPE html>
<html lang="en" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>pyautogui和键盘监听使用 - Hexo</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Fechin,"> 
    <meta name="description" content="Python基础之pyautogui模块（详细总结鼠标键盘操作）1. GUI 控制功能控制鼠标键盘使用的模块为：pyautogui，这个模块操作起鼠标键盘的时候，非常的迅速，而且如果该模块控制了鼠标,"> 
    <meta name="author" content="John Doe"> 
    <link rel="alternative" href="atom.xml" title="Hexo" type="application/atom+xml"> 
    
    
    
    
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="pyautogui和键盘监听使用 - Hexo"/>
    <meta name="twitter:description" content="Python基础之pyautogui模块（详细总结鼠标键盘操作）1. GUI 控制功能控制鼠标键盘使用的模块为：pyautogui，这个模块操作起鼠标键盘的时候，非常的迅速，而且如果该模块控制了鼠标,"/>
    
    
    
    
    <meta property="og:site_name" content="Hexo"/>
    <meta property="og:type" content="object"/>
    <meta property="og:title" content="pyautogui和键盘监听使用 - Hexo"/>
    <meta property="og:description" content="Python基础之pyautogui模块（详细总结鼠标键盘操作）1. GUI 控制功能控制鼠标键盘使用的模块为：pyautogui，这个模块操作起鼠标键盘的时候，非常的迅速，而且如果该模块控制了鼠标,"/>
    
<link rel="stylesheet" href="/css/diaspora.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body class="loading">
    <span id="config-title" style="display:none">Hexo</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="iconfont icon-home image-icon" href="javascript:;" data-url="http://example.com"></a>
    <div title="播放/暂停" class="iconfont icon-play"></div>
    <h3 class="subtitle">pyautogui和键盘监听使用</h3>
    <div class="social">
        <div>
            <div class="share">
                <a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">pyautogui和键盘监听使用</h1>
        <div class="stuff">
            <span>六月 05, 2022</span>
            

        </div>
        <div class="content markdown">
            <h1 id="Python基础之pyautogui模块（详细总结鼠标键盘操作）"><a href="#Python基础之pyautogui模块（详细总结鼠标键盘操作）" class="headerlink" title="Python基础之pyautogui模块（详细总结鼠标键盘操作）"></a>Python基础之pyautogui模块（详细总结鼠标键盘操作）</h1><h2 id="1-GUI-控制功能"><a href="#1-GUI-控制功能" class="headerlink" title="1. GUI 控制功能"></a>1. <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=GUI&spm=1001.2101.3001.7020">GUI</a> 控制功能</h2><p>控制鼠标键盘使用的模块为：<code>pyautogui</code>，这个模块操作起鼠标键盘的时候，非常的迅速，而且如果该模块控制了鼠标后，程序比较难关闭，这时我们有两个方法专门针对以上的情况：</p>
<h3 id="1-1-自动-防故障功能"><a href="#1-1-自动-防故障功能" class="headerlink" title="1.1 自动 防故障功能"></a>1.1 自动 防故障功能</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.FAILSAFE =<span class="literal">False</span>  </span><br></pre></td></tr></table></figure>

<p>默认这项功能为True, 这项功能意味着：当鼠标的指针在屏幕的最坐上方，程序会报错；目的是为了防止程序无法停止；</p>
<h3 id="1-2-停顿功能"><a href="#1-2-停顿功能" class="headerlink" title="1.2 停顿功能"></a>1.2 停顿功能</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.PAUSE = <span class="number">1</span>    </span><br></pre></td></tr></table></figure>

<p>意味着所有pyautogui的指令都要暂停一秒；其他指令不会停顿；这样做，可以防止键盘鼠标操作太快；</p>
<h2 id="2-鼠标操作"><a href="#2-鼠标操作" class="headerlink" title="2.鼠标操作"></a>2.鼠标操作</h2><h3 id="2-1-控制鼠标移动"><a href="#2-1-控制鼠标移动" class="headerlink" title="2.1 控制鼠标移动"></a>2.1 控制鼠标移动</h3><h3 id="3-获得屏幕分辨率"><a href="#3-获得屏幕分辨率" class="headerlink" title="3.获得屏幕分辨率"></a>3.获得屏幕分辨率</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(pyautogui.size())   # 返回所用显示器的分辨率； 输出：Size(width=1920, height=1080)</span><br><span class="line">width,height = pyautogui.size()</span><br><span class="line">print(width,height)  # 1920 1080</span><br></pre></td></tr></table></figure>

<p><strong>2. 移动鼠标</strong></p>
<ul>
<li>移动到指定位置</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.moveTo(<span class="number">100</span>,<span class="number">300</span>,duration=<span class="number">1</span>)   </span><br></pre></td></tr></table></figure>

<p>将鼠标移动到指定的坐标；duration 的作用是设置移动时间，所有的gui函数都有这个参数，而且都是可选参数；</p>
<ul>
<li>按方向移动</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.moveRel(<span class="number">100</span>,<span class="number">500</span>,duration=<span class="number">4</span>)   <span class="comment"># 第一个参数是左右移动像素值，第二个是上下，</span></span><br></pre></td></tr></table></figure>

<p>向右移动100px，向下移动500px, 这个过程持续 1 秒钟；</p>
<p><strong>3. 获取鼠标位置</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(pyautogui.position())   <span class="comment"># 得到当前鼠标位置；输出：Point(x=200, y=800)</span></span><br></pre></td></tr></table></figure>

<h3 id="2-2控制鼠标点击"><a href="#2-2控制鼠标点击" class="headerlink" title="2.2控制鼠标点击"></a>2.2控制鼠标点击</h3><p>单击鼠标</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.click(10,10)   # 鼠标点击指定位置，默认左键</span><br><span class="line">pyautogui.click(10,10,button=&#x27;left&#x27;)  # 单击左键</span><br><span class="line">pyautogui.click(1000,300,button=&#x27;right&#x27;)  # 单击右键</span><br><span class="line">pyautogui.click(1000,300,button=&#x27;middle&#x27;)  # 单击中间</span><br></pre></td></tr></table></figure>

<ul>
<li>双击鼠标</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.doubleClick(<span class="number">10</span>,<span class="number">10</span>)  <span class="comment"># 指定位置，双击左键</span></span><br><span class="line">pyautogui.rightClick(<span class="number">10</span>,<span class="number">10</span>)   <span class="comment"># 指定位置，双击右键</span></span><br><span class="line">pyautogui.middleClick(<span class="number">10</span>,<span class="number">10</span>)  <span class="comment"># 指定位置，双击中键</span></span><br></pre></td></tr></table></figure>

<ul>
<li>点击 &amp; 释放</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.mouseDown()   <span class="comment"># 鼠标按下</span></span><br><span class="line">pyautogui.mouseUp()    <span class="comment"># 鼠标释放</span></span><br><span class="line">pyautogui.mouseUp(button=<span class="string">&#x27;right&#x27;</span>, x=<span class="number">100</span>, y=<span class="number">200</span>)</span><br></pre></td></tr></table></figure>

<h3 id="2-3-控制鼠标拖动"><a href="#2-3-控制鼠标拖动" class="headerlink" title="2.3 控制鼠标拖动"></a>2.3 控制鼠标拖动</h3><ul>
<li>拖动到指定位置</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.dragTo(<span class="number">100</span>,<span class="number">300</span>,duration=<span class="number">1</span>)   </span><br></pre></td></tr></table></figure>

<p>将鼠标拖动到指定的坐标；duration 的作用是设置移动时间，所有的gui函数都有这个参数，而且都是可选参数；</p>
<ul>
<li>按方向拖动</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.dragRel(<span class="number">100</span>,<span class="number">500</span>,duration=<span class="number">4</span>)   <span class="comment"># 第一个参数是左右移动像素值，第二个是上下，</span></span><br></pre></td></tr></table></figure>

<p>向右拖动100px，向下拖动500px, 这个过程持续 1 秒钟；</p>
<h3 id="2-4-控制鼠标滚动"><a href="#2-4-控制鼠标滚动" class="headerlink" title="2.4 控制鼠标滚动"></a>2.4 控制鼠标滚动</h3><p>控制鼠标滚动的函数是scroll()， 传入一个整数的参数，说明向上或向下滚动多少个单位；单位根据操作系统不同而不同；</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.scroll(<span class="number">300</span>)  <span class="comment"># 向上滚动300个单位；</span></span><br></pre></td></tr></table></figure>

<h2 id="3-屏幕处理"><a href="#3-屏幕处理" class="headerlink" title="3. 屏幕处理"></a>3. 屏幕处理</h2><h3 id="3-1-获取屏幕截图"><a href="#3-1-获取屏幕截图" class="headerlink" title="3.1 获取屏幕截图"></a>3.1 获取屏幕截图</h3><p>我们控制鼠标的操作，不能盲目的进行，所以我们需要监控屏幕上的内容，从而决定要不要进行对应的操作， pyautogui 提供了一个方法screenshot()，可以返回一个Pillow的image对象；</p>
<p>这里有三个常用函数：</p>
<p><code>im = pyautogui.screenshot()</code>：返回屏幕的截图，是一个Pillow的image对象<br><code>im.getpixel((500, 500))</code>：返回im对象上，（500，500）这一点像素的颜色，是一个RGB元组</p>
<p><code>pyautogui.pixelMatchesColor(500,500,(12,120,400))</code> ：是一个对比函数，对比的是屏幕上（500，500）这一点像素的颜色，与所给的元素是否相同；</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">im = pyautogui.screenshot()</span><br><span class="line">im.save(&#x27;屏幕截图.png&#x27;)</span><br></pre></td></tr></table></figure>

<p>保存屏幕截图；</p>
<h3 id="3-2-识别图像"><a href="#3-2-识别图像" class="headerlink" title="3.2 识别图像"></a>3.2 识别图像</h3><p>首先，我们需要先获得一个屏幕快照，例如我们想要点赞，我们就先把大拇指的图片保存下来；然后使用函数：</p>
<p>locateOnScreen(‘zan.png’) ，如果可以找到图片，则返回图片的位置，如：Box(left=25, top=703, width=22, height=22)；如果找不到图片，则返回None;<br>如果，屏幕上有多处图片可以匹配，则需要使用locateAllOnScreen(‘zan.png’) ，如果匹配到多个值，则返回一个list，参考如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import pyautogui</span><br><span class="line">pyautogui.PAUSE = 1</span><br><span class="line"></span><br><span class="line"># 图像识别（一个）</span><br><span class="line">btm = pyautogui.locateOnScreen(&#x27;zan.png&#x27;)</span><br><span class="line">print(btm)  # Box(left=1280, top=344, width=22, height=22)</span><br><span class="line"></span><br><span class="line"># 图像识别（多个）</span><br><span class="line">btm = pyautogui.locateAllOnScreen(&#x27;zan.png&#x27;)</span><br><span class="line">print(list(btm))  # [Box(left=1280, top=344, width=22, height=22), Box(left=25, top=594, width=22, height=22)]</span><br></pre></td></tr></table></figure>

<p><code>pyautogui.center((left, top, width, height))</code> 返回指定位置的中心点；这样，我们就可以再配合鼠标操作点击找到图片的中心.</p>
<h2 id="4-键盘输入"><a href="#4-键盘输入" class="headerlink" title="4. 键盘输入"></a>4. 键盘输入</h2><h3 id="4-1-键盘输入函数"><a href="#4-1-键盘输入函数" class="headerlink" title="4.1 键盘输入函数"></a>4.1 键盘输入函数</h3><p><code>pyautogui.keyDown()</code> ： 模拟按键按下；<br><code>pyautogui.keyUp()</code> ： 模拟按键释放；<br><code>pyautogui.press()</code> ： # 就是调用keyDown() &amp; keyUp(),模拟一次按键；</p>
<p><code>pyautogui.typewrite(&#39;this&#39;,0.5)</code> ： 第一参数是输入内容，第二个参数是每个字符间的间隔时间；<br><code>pyautogui.typewrite([&#39;T&#39;,&#39;h&#39;,&#39;i&#39;,&#39;s&#39;])</code>：typewrite 还可以传入单字母的列表；</p>
<p>举例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.keyDown(&#x27;shift&#x27;)    # 按下shift</span><br><span class="line">pyautogui.press(&#x27;4&#x27;)    # 按下 4</span><br><span class="line">pyautogui.keyUp(&#x27;shift&#x27;)   # 释放 shift</span><br></pre></td></tr></table></figure>

<p>输出： $ ；</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.typewrite(<span class="string">&#x27;$$$$&#x27;</span>, <span class="number">0.5</span>)</span><br></pre></td></tr></table></figure>

<p>缓慢的输出：</p>
<h3 id="4-2-键盘特殊按键"><a href="#4-2-键盘特殊按键" class="headerlink" title="4.2 键盘特殊按键"></a>4.2 键盘特殊按键</h3><p>有时我们需要输入一些特殊的按键，比如向左的箭头，这些有相对应的键盘字符串表示，例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.typewrite([<span class="string">&#x27;T&#x27;</span>,<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;left&#x27;</span>,<span class="string">&#x27;left&#x27;</span>,<span class="string">&#x27;h&#x27;</span>,])   <span class="comment"># 输出：This</span></span><br></pre></td></tr></table></figure>

<p>解释：这里的left就是向左的箭头；诸如此类的键盘字符串，还有很多，参考下表：</p>
<p>键盘字符串    说明<br>enter(或return 或 \n)    回车<br>esc    ESC键<br>shiftleft, shiftright    左右SHIFT键<br>altleft, altright    左右ALT键<br>ctrlleft, ctrlright    左右CTRL键<br>tab (\t)    TAB键<br>backspace, delete    BACKSPACE 、DELETE键<br>pageup, pagedown    PAGE UP 和 PAGE DOWN键<br>home, end    HOME 和 END键<br>up, down, left,right    箭头键<br>f1, f2, f3…. f12    F1…….F12键<br>volumemute, volumedown,volumeup    声音变大变小静音（有些键盘没有）<br>pause    PAUSE键，暂停键<br>capslock    CAPS LOCK 键<br>numlock    NUM LOCK 键<br>scrolllock    SCROLLLOCK 键<br>insert    INSERT键<br>printscreen    PRINT SCREEN键<br>winleft, winright    Win键（windows ）<br>command    command键（Mac OS X ）<br>option    option（Mac OS X）</p>
<h3 id="4-3-快捷键"><a href="#4-3-快捷键" class="headerlink" title="4.3 快捷键"></a>4.3 快捷键</h3><p>如果我们需要模拟复制的快捷键 ctrl + c ，如果用前面的方法，则代码为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.keyDown(&#x27;ctrl&#x27;)</span><br><span class="line">pyautogui.keyDown(&#x27;c&#x27;)</span><br><span class="line">pyautogui.keyUp(&#x27;c&#x27;)</span><br><span class="line">pyautogui.keyUp(&#x27;ctrl&#x27;)</span><br></pre></td></tr></table></figure>

<p>快捷键的按键与释放顺序非常关键，这时我们可以使用 pyautogui.hotkey()，这个函数可以接受多个参数，按传入顺序按下，再按照相反顺序释放。上述快捷键 ctrl + c ，可以将代码变为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyautogui.hotkey(<span class="string">&#x27;ctrl&#x27;</span>,<span class="string">&#x27;c&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="5-提示信息框"><a href="#5-提示信息框" class="headerlink" title="5. 提示信息框"></a>5. 提示信息框</h2><h3 id="5-1-提示框-警告框"><a href="#5-1-提示框-警告框" class="headerlink" title="5.1 提示框/警告框"></a>5.1 提示框/警告框</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyautogui</span><br><span class="line">a = pyautogui.alert(text=<span class="string">&#x27;This is an alert box.&#x27;</span>, title=<span class="string">&#x27;Test&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<p>输出如下图：点击确定，返回值为‘OK’<br><img src="https://s2.loli.net/2022/06/05/nmGlIfEurCdL4ZJ.png" alt="在这里插入图片描述"></p>
<h3 id="5-2-选择框"><a href="#5-2-选择框" class="headerlink" title="5.2 选择框"></a>5.2 选择框</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyautogui</span><br><span class="line">a = pyautogui.confirm(<span class="string">&#x27;选择一项&#x27;</span>, buttons=[<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/06/05/Fi8q6yduhvTfK4m.png" alt="在这里插入图片描述"><br>输出如下图：点击B选项，返回值为‘B’</p>
<h3 id="5-3-密码输入"><a href="#5-3-密码输入" class="headerlink" title="5.3 密码输入"></a>5.3 密码输入</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyautogui</span><br><span class="line"></span><br><span class="line">a = pyautogui.password(<span class="string">&#x27;Enter password (text will be hidden)&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<p>输出如下图：输入密码，显示为密文，点击OK，返回值为刚刚输入的值；<br><img src="https://s2.loli.net/2022/06/05/NmAWt5kurljJo79.png" alt="在这里插入图片描述"></p>
<h3 id="5-4-普通输入"><a href="#5-4-普通输入" class="headerlink" title="5.4 普通输入"></a>5.4 普通输入</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyautogui</span><br><span class="line"></span><br><span class="line">a = pyautogui.prompt(<span class="string">&#x27;请输入一个数字：&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2022/06/05/PvgiDBfH6Oex7mz.png" alt="在这里插入图片描述"><br>输出如下图：显示为明文，点击OK，返回值为刚刚输入的值；</p>
<h2 id="6-实例"><a href="#6-实例" class="headerlink" title="6.实例"></a>6.实例</h2><h3 id="6-1-鼠标控制-鼠标画一个正方形"><a href="#6-1-鼠标控制-鼠标画一个正方形" class="headerlink" title="6.1 鼠标控制 鼠标画一个正方形"></a>6.1 鼠标控制 鼠标画一个正方形</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">for i in range(2):   # 画正方形</span><br><span class="line"> pyautogui.moveTo(200,200,duration=1)</span><br><span class="line"> pyautogui.moveTo(200,400,duration=1)</span><br><span class="line"> pyautogui.moveTo(400,400,duration=0.5)</span><br><span class="line"> pyautogui.moveTo(400,200,duration=2)</span><br></pre></td></tr></table></figure>

<h2 id="6-2-获取鼠标的实时位置"><a href="#6-2-获取鼠标的实时位置" class="headerlink" title="6.2 获取鼠标的实时位置"></a>6.2 获取鼠标的实时位置</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import pyautogui</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    while True:</span><br><span class="line">        x,y = pyautogui.position()</span><br><span class="line">        posi = &#x27;x:&#x27; + str(x).rjust(4) + &#x27; y:&#x27; + str(y).rjust(4)</span><br><span class="line">        print(&#x27;\r&#x27;,posi,end=&#x27;&#x27;)</span><br><span class="line">        time.sleep(0.5)</span><br><span class="line"></span><br><span class="line">except KeyboardInterrupt:</span><br><span class="line">    print(&#x27;已退出！&#x27;)</span><br></pre></td></tr></table></figure>

<p>显示效果：<br><img src="https://s2.loli.net/2022/06/05/Y6kevqR2nscJGhu.png" alt="在这里插入图片描述"></p>
<h3 id="6-3-获取鼠标位置-与-所在位置的颜色"><a href="#6-3-获取鼠标位置-与-所在位置的颜色" class="headerlink" title="6.3 获取鼠标位置 与 所在位置的颜色"></a>6.3 获取鼠标位置 与 所在位置的颜色</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import pyautogui</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    while True:</span><br><span class="line">        x,y = pyautogui.position()</span><br><span class="line">        rgb = pyautogui.screenshot().getpixel((x,y))</span><br><span class="line">        posi = &#x27;x:&#x27; + str(x).rjust(4) + &#x27; y:&#x27; + str(y).rjust(4) + &#x27;  RGB:&#x27; + str(rgb)</span><br><span class="line">        print(&#x27;\r&#x27;,posi,end=&#x27;&#x27;)</span><br><span class="line">        time.sleep(0.5)</span><br><span class="line"></span><br><span class="line">except KeyboardInterrupt:</span><br><span class="line">    print(&#x27;已退出！&#x27;)</span><br></pre></td></tr></table></figure>

<p>显示效果：<br><img src="https://s2.loli.net/2022/06/05/bjNOvfyEqd53epV.png" alt="在这里插入图片描述"></p>
<h3 id="6-4-自动点赞程序"><a href="#6-4-自动点赞程序" class="headerlink" title="6.4 自动点赞程序"></a>6.4 自动点赞程序</h3><p><img src="https://s2.loli.net/2022/06/05/lvr2ZWgpUcXfyFK.png" alt="在这里插入图片描述"></p>
<p>我们需要将所有的文章点赞，本页上的点赞完成后，就滚动鼠标，把新加载的文章也全部点赞；</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># author：Zhang Kai </span><br><span class="line"></span><br><span class="line">import pyautogui</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def zan():</span><br><span class="line">    time.sleep(0.5)    # 等待 0.5 秒</span><br><span class="line">    left, top, width, height = pyautogui.locateOnScreen(&#x27;zan.png&#x27;)   # 寻找 点赞图片；</span><br><span class="line">    center = pyautogui.center((left, top, width, height))    # 寻找 图片的中心</span><br><span class="line">    pyautogui.click(center)    # 点击</span><br><span class="line">    print(&#x27;点赞成功！&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    if pyautogui.locateOnScreen(&#x27;zan.png&#x27;):</span><br><span class="line">        zan()   # 调用点赞函数</span><br><span class="line">    else:</span><br><span class="line">        pyautogui.scroll(-500)    # 本页没有图片后，滚动鼠标；</span><br><span class="line">        print(&#x27;没有找到目标，屏幕下滚~&#x27;)</span><br></pre></td></tr></table></figure>

<h1 id="pynput的使用"><a href="#pynput的使用" class="headerlink" title="pynput的使用"></a>pynput的使用</h1><p>侦听按键</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from enum import Flag</span><br><span class="line">from time import sleep</span><br><span class="line">import pynput.keyboard as pk</span><br><span class="line">import sys</span><br><span class="line">import threading</span><br><span class="line">Flag = True</span><br><span class="line">def main():</span><br><span class="line">    while(Flag):</span><br><span class="line">        sleep(1)</span><br><span class="line">        print(1)</span><br><span class="line"># 连接事件以及释放</span><br><span class="line">def on_press(key):</span><br><span class="line">    # 监听按键</span><br><span class="line">    print(&quot;按键为&quot;,key)</span><br><span class="line">    if(key==pk.Key.esc):</span><br><span class="line">        globals()[&#x27;Flag&#x27;]=False</span><br><span class="line">        sys.exit(0)</span><br><span class="line">t2 = threading.Thread(target=main) # 创建线程2</span><br><span class="line">    # s.send(key.encode())</span><br><span class="line">t2.start() # 启动线程1</span><br><span class="line">with pk.Listener(on_press=on_press) as pklistener:</span><br><span class="line">    pklistener.join()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">global add</span><br></pre></td></tr></table></figure>

<p>侦听鼠标</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import pynput.keyboard as pk</span><br><span class="line">import pynput.mouse as pm</span><br><span class="line">import threading</span><br><span class="line"># def on_press(key):</span><br><span class="line">#     # 监听按键</span><br><span class="line">#     key=str(key)[1]</span><br><span class="line">#     print(&quot;按键为&quot;,key)</span><br><span class="line">#     # s.send(key.encode())</span><br><span class="line"># # 连接事件以及释放</span><br><span class="line"># with pk.Listener(on_press=on_press) as pklistener:</span><br><span class="line">#     pklistener.join()</span><br><span class="line">def on_click(x, y, button, pressed):</span><br><span class="line">    # 监听鼠标点击</span><br><span class="line">    if pressed:</span><br><span class="line">        print(&quot;按下坐标&quot;)</span><br><span class="line">        mxy=&quot;&#123;&#125;,&#123;&#125;&quot;.format(x, y)</span><br><span class="line">        print(mxy)</span><br><span class="line">        # s.send(mxy.encode())</span><br><span class="line">        # print(&#x27;Pressed&#x27;,(x, y))</span><br><span class="line">    if not pressed:</span><br><span class="line">        # Stop listener</span><br><span class="line">        return False</span><br><span class="line"></span><br><span class="line">def ls_k_thread():</span><br><span class="line">    while(1):</span><br><span class="line">        with pm.Listener(on_click=on_click) as pmlistener:</span><br><span class="line">            pmlistener.join()</span><br><span class="line">def analyse_pic_thread():</span><br><span class="line">    r = threading.Thread(target=ls_k_thread)</span><br><span class="line">    r.start()</span><br><span class="line">analyse_pic_thread()</span><br><span class="line"></span><br><span class="line">while(1):</span><br><span class="line">    pass</span><br></pre></td></tr></table></figure>


            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        
                            <li title="0" data-url="http://link.hhtjim.com/163/425570952.mp3"></li>
                        
                    
                        
                            <li title="1" data-url="http://link.hhtjim.com/163/425570952.mp3"></li>
                        
                    
                </ul>
            
        </div>
        
    <div id="gitalk-container" class="comment link"
		data-enable="false"
        data-ae="false"
        data-ci=""
        data-cs=""
        data-r=""
        data-o=""
        data-a=""
        data-d="false"
    >查看评论</div>


    </div>
    
</div>


    </div>
</div>
</body>


<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/typed.js"></script>
<script src="/js/diaspora.js"></script>


<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">


<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>






</html>
